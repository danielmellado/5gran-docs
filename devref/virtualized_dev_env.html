<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Virtual Developer Environment &mdash; 5G RAN docs  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Developer Guides" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> 5G RAN docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">5g RAN docs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Guides</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#developer-environment">Developer environment</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Virtual Developer Environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lab-architecture">Lab Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters-file">Parameters file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-cluster">Create cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="#debug-installation-process">Debug installation process</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">5G RAN docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Developer Guides</a> &raquo;</li>
      <li>Virtual Developer Environment</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/devref/virtualized_dev_env.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="virtual-developer-environment">
<h1>Virtual Developer Environment<a class="headerlink" href="#virtual-developer-environment" title="Permalink to this headline"></a></h1>
<p>We’ll be creating a virtualized cluster containing:</p>
<ul class="simple">
<li><p>3-Master OpenShift, including ACM, as hub cluster.</p></li>
<li><p>SNO cluster, managed by ACM as spoke.</p></li>
</ul>
<p>In order to do so, we’ll be relying on kcli as a tool to handle the creation
and configuration of the vms.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You’ll be in need of a server to handle this, as its memory requirements
would be probably greater than your latops. You should consider at least
16GBi of ram for every node and 32Gbi for the spoke and lab-installer ones.</p>
</div>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Install kcli <a class="reference external" href="https://github.com/karmab/kcli.git">https://github.com/karmab/kcli.git</a></p></li>
<li><p>Clone locally <a class="reference external" href="https://github.com/karmab/kcli-openshift4-baremetal">https://github.com/karmab/kcli-openshift4-baremetal</a></p></li>
<li><p>On the <cite>kcli-openshift4-baremetal</cite> directory, download a copy of your pull
secret file and name it as <cite>openshift_pull.json</cite></p></li>
</ul>
</section>
<section id="lab-architecture">
<h2>Lab Architecture<a class="headerlink" href="#lab-architecture" title="Permalink to this headline"></a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">+------------------------+--------+----------------------+------------------------------------------------------+------+---------+</span>
<span class="go">|          Name          | Status |         Ips          |                        Source                        | Plan | Profile |</span>
<span class="go">+------------------------+--------+----------------------+------------------------------------------------------+------+---------+</span>
<span class="go">|     lab-installer      |   up   | 2620:52:0:1302::978d | CentOS-Stream-GenericCloud-8-20210603.0.x86_64.qcow2 | lab  |  kvirt  |</span>
<span class="go">|      lab-master-0      |   up   |  2620:52:0:1302::20  |                                                      | lab  |  kvirt  |</span>
<span class="go">|      lab-master-1      |   up   |  2620:52:0:1302::21  |                                                      | lab  |  kvirt  |</span>
<span class="go">|      lab-master-2      |   up   |  2620:52:0:1302::22  |                                                      | lab  |  kvirt  |</span>
<span class="go">| lab-mgmt-spoke1-node-0 |   up   |  2620:52:0:1302::23  |                                                      | lab  |  kvirt  |</span>
<span class="go">+------------------------+--------+----------------------+------------------------------------------------------+------+---------+</span>
</pre></div>
</div>
<p>On top of the 3 masters and spoke commented above, the lab will also make of an
additional VM, called lab-installer, from which we’ll access the kubeconfig
files and kubernetes/openshift files.</p>
<p>Once deployed, you can access such machine by using:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kcli ssh lab-installer
</pre></div>
</div>
</section>
<section id="parameters-file">
<h2>Parameters file<a class="headerlink" href="#parameters-file" title="Permalink to this headline"></a></h2>
<p>Kcli needs a parameters file in order to run the installation. To do so, create
a file with the following parameters, name it as <cite>kcli_parameters.yml</cite> and put
it under the <cite>kcli-openshift4-baremetal</cite> directory.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">lab</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="nt">provisioning_enable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="nt">pool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span><span class="w"></span>
<span class="nt">disconnected</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="nt">virtual_masters</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="nt">virtual_workers_number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w"></span>
<span class="nt">launch_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="nt">deploy_openshift</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stable</span><span class="w"></span>
<span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4.9</span><span class="w"></span>
<span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lab</span><span class="w"></span>
<span class="nt">domain</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">karmalabs.com</span><span class="w"></span>
<span class="nt">baremetal_cidr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2620:52:0:1302::/64</span><span class="w"></span>
<span class="nt">baremetal_net</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lab-baremetal</span><span class="w"></span>
<span class="nt">virtual_masters_memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">24576</span><span class="w"></span>
<span class="nt">virtual_masters_numcpus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16</span><span class="w"></span>
<span class="nt">disk_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w"></span>
<span class="nt">api_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2620:52:0:1302::2</span><span class="w"></span>
<span class="nt">ingress_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2620:52:0:1302::3</span><span class="w"></span>
<span class="nt">monitoring_retention</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">24h</span><span class="w"></span>
<span class="nt">baremetal_ips</span><span class="p">:</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2620:52:0:1302::20</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2620:52:0:1302::21</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2620:52:0:1302::22</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2620:52:0:1302::23</span><span class="w"></span>
<span class="nt">baremetal_macs</span><span class="p">:</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aa:aa:aa:aa:bb:01</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aa:aa:aa:aa:bb:02</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aa:aa:aa:aa:bb:03</span><span class="w"></span>
<span class="nt">disconnected_operators</span><span class="p">:</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">advanced-cluster-management</span><span class="w"></span>
<span class="nt">ztp_spokes</span><span class="p">:</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mgmt-spoke1</span><span class="w"></span>
<span class="w">  </span><span class="nt">masters_number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<span class="w">  </span><span class="nt">workers_number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w"></span>
<span class="w">  </span><span class="nt">virtual_nodes_number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<span class="nt">vmrules</span><span class="p">:</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">lab-installer</span><span class="p">:</span><span class="w"></span>
<span class="w">     </span><span class="nt">disks</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">200</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="nt">lab_extra_dns</span><span class="p">:</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assisted-service-open-cluster-management</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assisted-service-assisted-installer</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assisted-image-service-open-cluster-management</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="create-cluster">
<h2>Create cluster<a class="headerlink" href="#create-cluster" title="Permalink to this headline"></a></h2>
<p>From the <cite>kcli-openshift4-baremetal</cite> directory, run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kcli create plan -f plans/kcli_plan_ztp.yml --paramfile kcli_parameters.yml lab
</pre></div>
</div>
</section>
<section id="debug-installation-process">
<h2>Debug installation process<a class="headerlink" href="#debug-installation-process" title="Permalink to this headline"></a></h2>
<p>Once you run the create plan command, just follow the installation process and
debug issues by following the output of cloud-init in the installer vm. Take
note that this may take a while to complete.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>kcli ssh lab-installer
<span class="gp">$ </span>tail -f /var/log/cloud-init-output.log
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Developer Guides" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>